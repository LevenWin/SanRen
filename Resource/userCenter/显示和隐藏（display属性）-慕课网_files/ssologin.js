function SSOController(){var t=this,i={success:function(){},error:function(){},complete:function(){}},e="ssoLoginFrame",r="ssoLoginForm",s="",n="",o=0,a=0,u=null,c=null,d=0,g={},l="/passport/user/login",f="/passport/user/register",h="/passport/user/prelogin";this.verifyCodeUrl="/passport/user/verifycode",this.checkVerifyUrl="/passport/user/loginverifyshow",this.checkVerifyCode="/passport/user/verifycheck",this.checkUserName="/passport/user/checkusername",this.checkNickName="/passport/user/checknickname",this.tpRegister="/passport/user/tpregister",this.tpBind="/passport/user/tpbind";var m=function(t){$(e).remove();var i=$("<iframe></iframe>");return i.css("display","none"),i.attr("id",t),i.attr("name",t),i.attr("src","javascript:void(0)"),i.appendTo("body"),i},p=function(t){$(r).remove();var i=$("<form></form>");i.attr("id",t),i.attr("name",t),i.attr("method","post"),i.css("display","none");for(var e in g)i.append($("<input type='text' name='"+e+"' value='"+g[e]+"' />"));return i.appendTo("body"),i},v=function(){if("undefined"==typeof XMLHttpRequest)return!1;var i=new XMLHttpRequest;return!1 in i?!1:($.ajax({url:l,data:g,method:"post",dataType:"json",xhrFields:{withCredentials:!0},success:function(i){if(10020==i.status){var e='<p class="warn-info">十分抱歉，由于您的帐号最近在实战中存在严重违规的情况，已做冻结帐号处理</p><p class="warn-tip">可能导致帐号冻结的原因  <a href="http://coding.imooc.com/user/faqdetail?column_id=2&id=17" target="_blank" >了解详情</a></p><div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-submit js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div>';$.dialog(e,{title:"提示",modal:!0}),$("#signin").remove(),$(".modal-backdrop").remove()}else if(10006==i.status){var e='<p class="warn-info">十分抱歉，由于您的帐号最近在慕课网中存在严重违规的情况，已做冻结帐号处理</p><div class="moco-modal-btns"><a class="moco-btn moco-btn-blue js-modal-submit js-warn-close" onclick="return false" href="javascript:void(0)"><span>确定</span></a></div>';$.dialog(e,{title:"提示",modal:!0}),$("#signin").remove(),$(".modal-backdrop").remove()}else t.ssoLoginCallBack(i);if($(".js-warn-close").size()>0){var r=function(){$(".moco-modal-layer").remove(),$(".js-moco-modal-cancel").remove()};$(document).on("click",".js-warn-close",r)}},error:function(){g.returntype="html",N()}}),!0)},w=function(){return"undefined"==typeof XMLHttpRequest?!1:(new XMLHttpRequest,$.ajax({url:f,data:g,method:"post",dataType:"json",success:function(i){t.ssoLoginCallBack(i)},error:function(){g.returntype="html",b()}}),!0)},N=function(){m(e);var t=p(r);t.attr("action",l),t.attr("target",e);try{t.submit()}catch(i){$(e).remove()}setTimeout(function(){$(t).remove()},10)},b=function(){m(e);var t=p(r);t.attr("action",f),t.attr("target",e);try{t.submit()}catch(i){$(e).remove()}setTimeout(function(){$(t).remove()},10)},y=function(t){clearInterval(a),a=null,s=t.pubkey,n=t.code,o=t.servertime,setInterval(function(){o++},1e3)};this.preLogin=function(t){return s&&n?(t.success&&t.success(),void 0):(t=t||{success:function(){},error:function(){}},$.ajax({url:h,method:"post",dataType:"json",success:function(i){10001==i.status?(y(i),t.success&&t.success()):t.error&&t.error()},error:function(){t.error()}}),void 0)},this.setCrossDomainCookie=function(i){d=i.length;for(var e=0;e<i.length;e++)url=i[e],$.get(url,function(){d--,0==d&&(clearTimeout(c),t.crossDomainResult())},"jsonp")},this.ssoLoginCallBack=function(e){10001==e.status?(u=function(){i.success(e),i.complete()},this.setCrossDomainCookie(e.data.url),c=setTimeout(function(){t.crossDomainResult()},5e3)):(i.success(e),i.complete())},this.crossDomainResult=function(){"function"==typeof u&&u()},this.crossDomainAction=function(i){return"function"==typeof i&&(u=i),c=setTimeout(function(){t.crossDomainResult()},5e3),!1},this.frameLoginCallBack=function(t){i.success(t),i.complete(),$(e).remove()},this.login=function(t){if(t.data.pwencode){if(""==n||0==o||""==s)return t.error(),t.complete(),this.preLogin(),void 0;var e=k(n+"	"+o+"	"+t.data.password);t.data.password=window.btoa(e)}return g=t.data,g.referer=window.location.protocol+"//"+window.location.hostname,i={success:t.success,error:t.error,complete:t.complete},v()?!0:(g.returntype="html",N(),void 0)},this.register=function(t){return i={success:t.success,error:t.error,complete:t.complete},g=t.data,g.referer=window.location.protocol+"//"+window.location.hostname,w()?!0:(g.returntype="html",b(),void 0)};var k=function(t){function i(t){R=t,D=new Array(R);for(var i=0;i<D.length;i++)D[i]=0;q=new e,B=new e,B.digits[0]=1}function e(t){this.digits="boolean"==typeof t&&1==t?null:D.slice(0),this.isNeg=!1}function r(t){var i=new e(!0);return i.digits=t.digits.slice(0),i.isNeg=t.isNeg,i}function n(t){var i=new e;i.isNeg=0>t,t=Math.abs(t);for(var r=0;t>0;)i.digits[r++]=t&U,t>>=H;return i}function o(t){var i,e=48,r=e+9,s=97,n=s+25,o=65,a=90;return i=t>=e&&r>=t?t-e:t>=o&&a>=t?10+t-o:t>=s&&n>=t?10+t-s:0}function a(t){for(var i=0,e=Math.min(t.length,4),r=0;e>r;++r)i<<=4,i|=o(t.charCodeAt(r));return i}function u(t){for(var i=new e,r=t.length,s=r,n=0;s>0;s-=4,++n)i.digits[n]=a(t.substr(Math.max(s-4,0),Math.min(s,4)));return i}function c(t){for(var i="",e=f(t);e>-1;--e)i+=d(t.digits[e]);return i}function d(t){var i=String.fromCharCode(255&t);t>>>=8;var e=String.fromCharCode(255&t);return e+i}function g(t,i){var r;if(t.isNeg!=i.isNeg)i.isNeg=!i.isNeg,r=l(t,i),i.isNeg=!i.isNeg;else{r=new e;for(var s,n=0,o=0;o<t.digits.length;++o)s=t.digits[o]+i.digits[o]+n,r.digits[o]=65535&s,n=Number(s>=X);r.isNeg=t.isNeg}return r}function l(t,i){var r;if(t.isNeg!=i.isNeg)i.isNeg=!i.isNeg,r=g(t,i),i.isNeg=!i.isNeg;else{r=new e;var s,n;n=0;for(var o=0;o<t.digits.length;++o)s=t.digits[o]-i.digits[o]+n,r.digits[o]=65535&s,r.digits[o]<0&&(r.digits[o]+=X),n=0-Number(0>s);if(-1==n){n=0;for(var o=0;o<t.digits.length;++o)s=0-r.digits[o]+n,r.digits[o]=65535&s,r.digits[o]<0&&(r.digits[o]+=X),n=0-Number(0>s);r.isNeg=!t.isNeg}else r.isNeg=t.isNeg}return r}function f(t){for(var i=t.digits.length-1;i>0&&0==t.digits[i];)--i;return i}function h(t){var i,e=f(t),r=t.digits[e],s=(e+1)*O;for(i=s;i>s-O&&0==(32768&r);--i)r<<=1;return i}function m(t,i){for(var r,s,n,o=new e,a=f(t),u=f(i),c=0;u>=c;++c){for(r=0,n=c,j=0;a>=j;++j,++n)s=o.digits[n]+t.digits[j]*i.digits[c]+r,o.digits[n]=s&U,r=s>>>H;o.digits[c+a+1]=r}return o.isNeg=t.isNeg!=i.isNeg,o}function p(t,i){var r,s,n;result=new e,r=f(t),s=0;for(var o=0;r>=o;++o)n=result.digits[o]+t.digits[o]*i+s,result.digits[o]=n&U,s=n>>>H;return result.digits[1+r]=s,result}function v(t,i,e,r,s){for(var n=Math.min(i+s,t.length),o=i,a=r;n>o;++o,++a)e[a]=t[o]}function w(t,i){var r=Math.floor(i/O),s=new e;v(t.digits,0,s.digits,r,s.digits.length-r);for(var n=i%O,o=O-n,a=s.digits.length-1,u=a-1;a>0;--a,--u)s.digits[a]=s.digits[a]<<n&U|(s.digits[u]&E[n])>>>o;return s.digits[0]=s.digits[a]<<n&U,s.isNeg=t.isNeg,s}function N(t,i){var r=Math.floor(i/O),s=new e;v(t.digits,r,s.digits,0,t.digits.length-r);for(var n=i%O,o=O-n,a=0,u=a+1;a<s.digits.length-1;++a,++u)s.digits[a]=s.digits[a]>>>n|(s.digits[u]&V[n])<<o;return s.digits[s.digits.length-1]>>>=n,s.isNeg=t.isNeg,s}function b(t,i){var r=new e;return v(t.digits,0,r.digits,i,r.digits.length-i),r}function y(t,i){var r=new e;return v(t.digits,i,r.digits,0,r.digits.length-i),r}function k(t,i){var r=new e;return v(t.digits,0,r.digits,0,i),r}function M(t,i){if(t.isNeg!=i.isNeg)return 1-2*Number(t.isNeg);for(var e=t.digits.length-1;e>=0;--e)if(t.digits[e]!=i.digits[e])return t.isNeg?1-2*Number(t.digits[e]>i.digits[e]):1-2*Number(t.digits[e]<i.digits[e]);return 0}function $(t,i){var s,n,o=h(t),a=h(i),u=i.isNeg;if(a>o)return t.isNeg?(s=r(B),s.isNeg=!i.isNeg,t.isNeg=!1,i.isNeg=!1,n=l(i,t),t.isNeg=!0,i.isNeg=u):(s=new e,n=r(t)),new Array(s,n);s=new e,n=t;for(var c=Math.ceil(a/O)-1,d=0;i.digits[c]<F;)i=w(i,1),++d,++a,c=Math.ceil(a/O)-1;n=w(n,d),o+=d;for(var m=Math.ceil(o/O)-1,v=b(i,m-c);-1!=M(n,v);)++s.digits[m-c],n=l(n,v);for(var y=m;y>c;--y){var k=y>=n.digits.length?0:n.digits[y],$=y-1>=n.digits.length?0:n.digits[y-1],C=y-2>=n.digits.length?0:n.digits[y-2],j=c>=i.digits.length?0:i.digits[c],S=c-1>=i.digits.length?0:i.digits[c-1];s.digits[y-c-1]=k==j?U:Math.floor((k*X+$)/j);for(var A=s.digits[y-c-1]*(j*X+S),L=k*I+($*X+C);A>L;)--s.digits[y-c-1],A=s.digits[y-c-1]*(j*X|S),L=k*X*X+($*X+C);v=b(i,y-c-1),n=l(n,p(v,s.digits[y-c-1])),n.isNeg&&(n=g(n,v),--s.digits[y-c-1])}return n=N(n,d),s.isNeg=t.isNeg!=u,t.isNeg&&(s=u?g(s,B):l(s,B),i=N(i,d),n=l(i,n)),0==n.digits[0]&&0==f(n)&&(n.isNeg=!1),new Array(s,n)}function C(t,i){return $(t,i)[0]}function S(t){this.modulus=r(t),this.k=f(this.modulus)+1;var i=new e;i.digits[2*this.k]=1,this.mu=C(i,this.modulus),this.bkplus1=new e,this.bkplus1.digits[this.k+1]=1,this.modulo=A,this.multiplyMod=L,this.powMod=T}function A(t){var i=y(t,this.k-1),e=m(i,this.mu),r=y(e,this.k+1),s=k(t,this.k+1),n=m(r,this.modulus),o=k(n,this.k+1),a=l(s,o);a.isNeg&&(a=g(a,this.bkplus1));for(var u=M(a,this.modulus)>=0;u;)a=l(a,this.modulus),u=M(a,this.modulus)>=0;return a}function L(t,i){var e=m(t,i);return this.modulo(e)}function T(t,i){var r=new e;r.digits[0]=1;for(var s=t,n=i;;){if(0!=(1&n.digits[0])&&(r=this.multiplyMod(r,s)),n=N(n,1),0==n.digits[0]&&0==f(n))break;s=this.multiplyMod(s,s)}return r}function x(t){var i=1024;this.e=u("10001"),this.d=u(""),this.m=u(t),this.chunkSize="number"!=typeof i?2*f(this.m):i/8,this.radix=16,this.barrett=new S(this.m)}function z(t){var i,r,n,o,a,u,d,g,l=new Array,f=t.length,h="",m=new x(s);for(f>m.chunkSize-11&&(f=m.chunkSize-11),i=0,r=f-1;f>i;)l[r]=t.charCodeAt(i),i++,r--;for(r=m.chunkSize-f%m.chunkSize;r>0;){for(o=Math.floor(256*Math.random());!o;)o=Math.floor(256*Math.random());l[i]=o,i++,r--}for(l[f]=0,l[m.chunkSize-2]=2,l[m.chunkSize-1]=0,a=l.length,i=0;a>i;i+=m.chunkSize){for(u=new e,r=0,n=i;n<i+m.chunkSize;++r)u.digits[r]=l[n++],u.digits[r]+=l[n++]<<8;d=m.barrett.powMod(u,m.e),g=c(d),h+=g}return h}var R,D,q,B,H=16,O=H,X=65536,F=X>>>1,I=X*X,U=X-1;i(20),n(1e15),new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"),new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var E=new Array(0,32768,49152,57344,61440,63488,64512,65024,65280,65408,65472,65504,65520,65528,65532,65534,65535),V=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);return i(131),z(t)}}!function(){function t(t){this.message=t}var i="undefined"!=typeof exports?exports:self,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",i.btoa||(i.btoa=function(i){for(var r,s,n=String(i),o=0,a=e,u="";n.charAt(0|o)||(a="=",o%1);u+=a.charAt(63&r>>8-8*(o%1))){if(s=n.charCodeAt(o+=.75),s>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");r=r<<8|s}return u}),i.atob||(i.atob=function(i){var r=String(i).replace(/=+$/,"");if(1==r.length%4)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var s,n,o=0,a=0,u="";n=r.charAt(a++);~n&&(s=o%4?64*s+n:n,o++%4)?u+=String.fromCharCode(255&s>>(6&-2*o)):0)n=e.indexOf(n);return u})}(),imoocSSO=new SSOController;